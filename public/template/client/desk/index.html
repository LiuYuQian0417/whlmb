{extend name='layout/frame' /}
{block name='title'}{__block__}{/block}
{block name='body'}
{__block__}
<script src="__RES__/js/common/jquery-1.8.2.min.js"></script>
<script src="__RES__/layui/layui.js"></script>
<script src="__RES__/js/common/main.js"></script>
<link rel="stylesheet" href="__RES__/css/common/home.css">
<style>
    .goodsDataList .list {
        width: 50.55% !important;
    }

    .text {
        border: none;
        width: 100%;
    }

    .text:hover {
        border: none;
    }

    .dataTabCon .dataList li .group .type {
        display: flex;
        flex-direction: column;
    }

    .dataTabList ul li {
        position: relative;
        border: none;
        padding-left: 10px;
    }

    .dataTabList ul li:before {
        position: absolute;
        width: 3px;
        height: 20px;
        background-color: #f98a10;
        left: 0;
        top: 0;
        margin-top: 5px;
        content: '';
    }

    .dataTabCon .dataList li.list .number {
        /*padding-left: 40px;*/
    }

    .homeHead .btn {
        background-color: #f98a10;
        border: 1px solid #f98a10;
    }

    .homeHead .btn > a {
        color: #fff;
    }

    .setBtn > a {
        color: #f98a10;
    }

    .layui-input, .layui-select, .layui-textarea {
        height: 30px;
    }

    .self-info {
        overflow: hidden;
        margin-top: 50px;
        font-size: 12px;
        color: #494949;
    }

    .self-info > li {
        float: left;
        width: calc(33.3% - 22px);
        border-left: 1px solid #f1f1f1;
        padding: 0 10px;
        height: 66px;
    }

    .self-info > li:first-child {
        border-left: transparent;
    }

    .self-info .self-address {
        overflow: hidden;
        text-overflow: ellipsis;
        display: -webkit-box;
        -webkit-line-clamp: 2;
        -webkit-box-orient: vertical;
        width: 187px;
    }
</style>
<form class="layui-form">
    <div class="stageWrap">
        <div class="homeHead">
            <img src="{:session('client_storeLogo')}" alt="" class="logoIcon"
                 onerror=this.src="/template/master/resource/image/common/imageError.png">
            <div class="info">
                <div class="homeName">{:session('client_storeName')}</div>
            </div>
            <!--<div class="btn">-->
                <!--<a href="javascript:void(0);"-->
                   <!--onClick="main.jumpFour('client/goods/create?shop={:input(\'get.type\',1)}')">添加商品</a>-->
            <!--</div>-->
            <!--<div class="btn">-->
                <!--<a href="javascript:void(0);" onClick="main.jumpFour('client/store_capital/index')">提现</a>-->
            <!--</div>-->
            <!--<div class="btn">-->
                <!--<a href="javascript:void(0);" onclick="entrance()">访问平台</a>-->
            <!--</div>-->
            <!--<div class="btn">-->
                <!--<a href="javascript:void(0);" onclick="checkCode()">核销</a>-->
            <!--</div>-->
            <div class="setBtn">
                <a href="javascript:void(0);" onClick="main.jumpFour('client/store/index')">店铺设置</a>
            </div>
        </div>
        <div class="dataTab master">
            <div class="dataTabList">
                <ul>
                    <li class="active">店铺数据</li>
                </ul>
                <div class="ope">
                    <div class="time">更新时间:{$time}</div>
                    <i class="fa fa-refresh" aria-hidden="true" onclick="location.reload();"></i>
                    <!--<a href="javascript:void(0);" style="color: #f98a10;" class="more" onclick="contact()">更多数据></a>-->
                </div>
            </div>
            <div class="dataTabCon">
                <div>
                    <ul class="dataList">
                        <li class="list">
                            <img src="__RES__/image/common/homeIcon2.png" alt="" class="icon">
                            <div class="group">
                                <div class="type">
                                    <div class="text">店铺支付金额(元) <img src="__RES__/image/common/homeHelp.png" alt=""
                                                                     class="help"
                                                                     title="0点至当前时间内平台所有付款订单金额总和(拼团在成团时计入付款金额;货到付款在发货时计入付款金额，不剔除退款金额)">
                                    </div>
                                    <div class="number green">{$item.self_pay_total}</div>
                                </div>
                                <div class="type">
                                    <div class="text">店铺支付订单数 <img src="__RES__/image/common/homeHelp.png" alt=""
                                                                   class="help"
                                                                   title="0点至当前时间内店铺成功付款订单数，订单号唯一。场景1，拼团在成团时计入支付订单数。场景2，货到付款在发货时计入支付订单数">
                                    </div>
                                    <div class="number green">{$item.self_indent_count}</div>
                                </div>
                                <div class="type">
                                    <div class="text">店铺支付买家数 <img src="__RES__/image/common/homeHelp.png" alt=""
                                                                   class="help" title="0点至当前时间内店铺付款成功的用户数，单个用户多次付款只记一次">
                                    </div>
                                    <div class="number green">{$item.self_member_pay_count}</div>
                                </div>
                                <!--<div class="type">-->
                                <!--<div class="text">店铺访客数 <img src="__RES__/image/common/homeHelp.png" alt="" class="help" title="0点至当前时间内店铺页面被访问的去重人数，单个用户在统计时间范围内访问多次只记一次" ></div>-->
                                <!--<div class="number green">8800</div>-->
                                <!--</div>-->
                                <!--<div class="type">-->
                                <!--<div class="text">店铺浏览量 <img src="__RES__/image/common/homeHelp.png" alt="" class="help" title="0点至当前时间内店铺页面被访问次数，单个用户在统计时间内访问多次记多次"></div>-->
                                <!--<div class="number green">8800</div>-->
                                <!--</div>-->
                            </div>
                        </li>
                        <li class="list">
                            <img src="__RES__/image/common/homeIcon3.png" alt="" class="icon">
                            <div class="group">
                                <div class="type">
                                    <div class="text">店铺待发货订单 <img src="__RES__/image/common/homeHelp.png" alt=""
                                                                   class="help" title="截止到当前时间内的店铺未发货订单数"></div>
                                    <div class="number purple">{$item.self_not_deliver}</div>
                                </div>
                                <div class="type">
                                    <div class="text">店铺退款维权订单 <img src="__RES__/image/common/homeHelp.png" alt=""
                                                                    class="help" title="截止到当前时间内的店铺退款维权订单数"></div>
                                    <div class="number purple">{$item.self_is_refund}</div>
                                </div>
                            </div>
                        </li>
                        <li class="list">
                            <img src="__RES__/image/common/homeIcon4.png" alt="" class="icon">
                            <div class="group">
                                <div class="type">
                                    <div class="text">店铺出售中 <img src="__RES__/image/common/homeHelp.png" alt=""
                                                                 class="help" title="截止到当前时间内的店铺出售中的商品数"></div>
                                    <div class="number yellow">{$item.self_sales_goods_count}</div>
                                </div>
                                <div class="type">
                                    <div class="text">店铺库存预警 <img src="__RES__/image/common/homeHelp.png" alt=""
                                                                  class="help" title="截止到当前时间内店铺库存预警的商品数"></div>
                                    <div class="number yellow">{$item.self_goods_number.goods_warn_number}</div>
                                </div>
                                <!--<div class="type">-->
                                    <!--<div class="text">店铺仓库中 <img src="__RES__/image/common/homeHelp.png" alt=""-->
                                                                 <!--class="help" title="截止到当前时间内的店铺仓库中的商品数"></div>-->
                                    <!--<div class="number yellow">{$item.self_warehouse_goods_count}</div>-->
                                <!--</div>-->
                                <div class="type">
                                    <div class="text">店铺回收站 <img src="__RES__/image/common/homeHelp.png" alt=""
                                                                 class="help" title="截止到当前时间内的店铺回收站的商品数"></div>
                                    <div class="number yellow">{$item.self_recycle_goods_count}</div>
                                </div>
                            </div>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
        <div class="dataTab master">
            <div class="dataTabList">
                <ul>
                    <li class="active">商品榜单</li>
                </ul>
                <div class="ope layui-form">
                    <div class="layui-inline">
                        <label class="layui-form-label">时间筛选</label>
                        <div class="layui-input-inline">
                            <input type="text" class="layui-input lay-input" id="date1" name="date1"
                                   value="{:input('get.date1','')}" readonly placeholder="日期范围查询" style="padding: 0 20px">
                        </div>
                        <!--<button class="sc-btn sc-blueBg-btn btn30" lay-submit="">搜索</button>-->
                        <a class="sc-btn sc-blueBg-btn btn30" href="javascript:void(0);" onclick="goodsPayAll()">查询</a>
                    </div>
                </div>
            </div>
            <div class="goodsDataList">
                <div class="list" style="display: none;">
                    <div class="totalTitle">商品访客数 <img src="__RES__/image/common/homeHelp.png" alt="" class="help"
                                                       title="商品访客数商品访客数商品访客数商品访客数商品访客数"></div>
                    <table class="goodsDataTable layui-table">
                        <thead>
                        <tr>
                            <th style="width: 30px;">排名</th>
                            <th style="text-align: left!important;">商品名称</th>
                            <th style="width: 20%;">商品访客数</th>
                        </tr>
                        </thead>
                        <tbody>
                        <tr>
                            <td>1</td>
                            <td>
                                <div class="goodsInfo">
                                    <img src="__RES__/image/common/imageError.png" alt="" class="goodsPic">
                                    <div class="det">
                                        <div class="goodsName">自制2018秋冬港味宽松中长款纯棉字母圆领ins同款短袖白色T恤女</div>
                                        <div class="time">发布时间：2018-02-03 18:00:00</div>
                                    </div>
                                </div>
                            </td>
                            <td>19878</td>
                        </tr>
                        <tr>
                            <td>2</td>
                            <td>
                                <div class="goodsInfo">
                                    <img src="__RES__/image/common/imageError.png" alt="" class="goodsPic">
                                    <div class="det">
                                        <div class="goodsName">自制2018秋冬港味宽松中长款纯棉字母圆领ins同款短袖白色T恤女</div>
                                        <div class="time">发布时间：2018-02-03 18:00:00</div>
                                    </div>
                                </div>
                            </td>
                            <td>19878</td>
                        </tr>
                        <tr>
                            <td>3</td>
                            <td>
                                <div class="goodsInfo">
                                    <img src="__RES__/image/common/imageError.png" alt="" class="goodsPic">
                                    <div class="det">
                                        <div class="goodsName">自制2018秋冬港味宽松中长款纯棉字母圆领ins同款短袖白色T恤女</div>
                                        <div class="time">发布时间：2018-02-03 18:00:00</div>
                                    </div>
                                </div>
                            </td>
                            <td>19878</td>
                        </tr>
                        <tr>
                            <td>4</td>
                            <td>
                                <div class="goodsInfo">
                                    <img src="__RES__/image/common/imageError.png" alt="" class="goodsPic">
                                    <div class="det">
                                        <div class="goodsName">自制2018秋冬港味宽松中长款纯棉字母圆领ins同款短袖白色T恤女</div>
                                        <div class="time">发布时间：2018-02-03 18:00:00</div>
                                    </div>
                                </div>
                            </td>
                            <td>19878</td>
                        </tr>
                        <tr>
                            <td>5</td>
                            <td>
                                <div class="goodsInfo">
                                    <img src="__RES__/image/common/imageError.png" alt="" class="goodsPic">
                                    <div class="det">
                                        <div class="goodsName">自制2018秋冬港味宽松中长款纯棉字母圆领ins同款短袖白色T恤女</div>
                                        <div class="time">发布时间：2018-02-03 18:00:00</div>
                                    </div>
                                </div>
                            </td>
                            <td>19878</td>
                        </tr>
                        </tbody>
                        <tfoot>
                        <tr>

                        </tr>
                        </tfoot>
                    </table>
                </div>
                <div class="list">
                    <div class="totalTitle">商品支付金额 <img src="__RES__/image/common/homeHelp.png" alt="" class="help"
                                                        title="统计时间内的商品所有付款订单金额总和(拼团在成团时计入付款金额;货到付款在发货时计入付款金额，不剔除退款金额)">
                    </div>
                    <table class="goodsDataTable layui-table" id="goodsPayTable">
                        <thead>
                        <tr>
                            <th style="width: 30px;">排名</th>
                            <th style="text-align: left!important;">商品名称</th>
                            <th style="width: 20%;">商品支付金额</th>
                        </tr>
                        </thead>
                        <tbody id="goodsPay">

                        </tbody>

                    </table>
                </div>
                <div class="list">
                    <div class="totalTitle">商品销量 <img src="__RES__/image/common/homeHelp.png" alt="" class="help"
                                                       title="统计时间内商品成功下单的数量"></div>
                    <table class="goodsDataTable layui-table" id="goodsCountTable">
                        <thead>
                        <tr>
                            <th style="width: 30px;">排名</th>
                            <th style="text-align: left!important;">商品名称</th>
                            <th style="width: 20%;">商品销量</th>
                        </tr>
                        </thead>
                        <tbody id="goodsCount">

                        </tbody>

                    </table>
                </div>

            </div>
        </div>

        <!--<div class="contact" onclick="contact()">如需更全面的数据统计，请联系 <span>0451-58977072</span></div>-->
    </div>
</form>

<div style="position: fixed;left: 0;top: 0;width: 100vw;height: 100vh;display: flex;align-items: center;justify-content: center;background: #aaaaaa; display: none;">
    <div style="background: white;width: 690px;height: 410px;">
        <div style="width: 630px;height: 410px;margin: 0 auto;">
            <ul class="self-info">
                <li>
                    <div>收货人：三方</div>
                    <div>手机号码：12341564564</div>
                </li>
                <li>
                    <div>自提点名称：三方</div>
                    <div class="self-address">自提地址：加速离开家发生的龙卷风雷声大减肥啦可是定金阿士大夫撒旦法士大夫</div>
                </li>
                <li>
                    <div>自提地址：三方</div>
                    <div>手机号码：12341564564</div>
                </li>
            </ul>

        </div>
    </div>
</div>

{/block}
{block name='js'}
{__block__}
<script src="__RES__/js/common/jQuery.toolTip.js"></script>
<script src="__RES__/js/pages.js"></script>
<script>
    $('.help').toolTip({fade: true});
    $(function () {
        // 数据切换 平台/自营
        $(".master .dataTabList li").click(function () {
            var index = $(this).index();
            $(this).addClass("active").siblings().removeClass("active")
            $(".dataTabCon>div").eq(index).show().siblings().hide()
        })
        goodsPayAll()
    })
    main.form();
    main.laydate([{
        elem: "#date",
        type: "date",
        range: true,
        max: 0
    }]);
    main.laydate([{
        elem: "#date1",
        type: "date",
        range: true,
        max: 0
    }]);

    function goodsPayAll(){
        goodsPay();
        goodsCount();
    }

    function goodsPay(pages) {
        var date = $('#date1').val();
        $('tr[data_type="goodsPay"] ').remove();
        $('#goodsPay tr').remove();

        main.ajax({
            type: 'post',
            async:true,
            data: {date: date, page: pages === undefined ? 1 : pages}, url: '/client/desk/goodsPay', callback: function (res) {
                if (res.code != 0) {
                    layer.msg(res.message);
                    return false;
                } else {
                    $('#goodsPayTable').children('tfoot').remove()

                    res.page.current_page = parseInt(res.page.current_page)
                    res.page.last_page = parseInt(res.page.last_page)

                    if (res.page.last_page !== 0) {
                        $('#goodsPayTable').append('<tfoot><tr><td colspan="100"><span style="float:right;"><ul class="pagination"></ul></span></td></tr></tfoot>')
                        $('#goodsPayTable').find('ul.pagination').pagination({
                            currentPage:res.page.current_page,
                            prevText: '«',
                            nextText: '»',
                            pages: res.page.last_page, //总页数
                            edges: 2,
                            cssStyle: 'pagination-sm', //按纽大小pagination-lg或写入自定义css
                            displayedPages: 9, //显示几个
                            onPageClick: function(pageNumber, event) {
                                goodsPay(pageNumber)
                            },
                            onInit: function(getid) {
                                //刷新时或初始化调用
                                // alert(getid);
                            }
                        });
                    }
                    $('#goodsPay').append(res.data);
                }
            }
        });
    }

    function goodsCount(pages) {
        var date = $('#date1').val();
        $('tr[data_type="goodsCount"] ').remove();
        $('#goodsCount tr').remove();
        main.ajax({
            type: 'post',
            async:true,
            data: {date: date, page: pages === undefined ? 1 : pages}, url: '/client/desk/goodsCountPay', callback: function (res) {
                if (res.code != 0) {
                    layer.msg(res.message);
                    return false;
                } else {
                    $('#goodsCountTable').children('tfoot').remove()

                    res.page.current_page = parseInt(res.page.current_page)
                    res.page.last_page = parseInt(res.page.last_page)

                    if (res.page.last_page !== 0) {
                        $('#goodsCountTable').append('<tfoot><tr><td colspan="100"><span style="float:right;"><ul class="pagination"></ul></span></td></tr></tfoot>')
                        $('#goodsCountTable').find('ul.pagination').pagination({
                            currentPage:res.page.current_page,
                            prevText: '«',
                            nextText: '»',
                            pages: res.page.last_page, //总页数
                            edges: 2,
                            cssStyle: 'pagination-sm', //按纽大小pagination-lg或写入自定义css
                            displayedPages: 9, //显示几个
                            onPageClick: function(pageNumber, event) {
                                goodsCount(pageNumber)
                            },
                            onInit: function(getid) {
                                //刷新时或初始化调用
                                // alert(getid);
                            }
                        });
                    }
                    $('#goodsCount').append(res.data);
                }
            }
        })
    }

    function contact() {
        layer.open({
            type: 1,
            title: '更多数据',
            shadeClose: true,
            area: ['440px', '220px'],
            skin: 'layui-layer-rim',
            content: '<div class="moreData"><div>如需更全面的数据统计，请联系<span style="color: #f98a10;">0451-58977072</span></div></div>'
        });
    }

    function withdraw(obj) {
        layer.open({
            type: 2,
            title: obj.title,
            move: false,
            shadeClose: true,
            area: ['50%', '670px'],
            btn: obj.btn,
            content: '/client/store_capital/withdraw'
        });
    }

    function entrance() {
        layer.open({
            type: 1,
            title: '访问平台',
            shadeClose: true,
            area: ['440px', '320px'],
            skin: 'layui-layer-rim',
            content: '<img style="width: 150px;height: 150px;margin-top: 50px;margin-left: 50px;" src="{$applet_code_file}">' +
                '<img style="width: 150px;height: 150px;margin-top: 50px;margin-left: 50px;" src="{$official_accounts}">' +
                '<span></span>'
        });
    }

    function checkCode() {
        layer.open({
            type: 1,
            title: '访问平台',
            shadeClose: true,
            area: ['690px', '410px'],
            skin: 'layui-layer-rim',
            content: '<div></div>'
        });
    }
</script>

{/block}


<!--<style>-->
<!--.layui-tab-title .layui-this{-->
<!--background-color:#fff!important;-->
<!--}-->
<!--.show{-->
<!--margin-top:1%;padding: 20px; background-color: #F2F2F2;-->
<!--}-->
<!--.font-style{-->
<!--color: #f23030;font-weight: bold;font-size: 20px;-->
<!--}-->
<!--.collect_display td{border: hidden!important;}-->
<!--</style>-->
<!--&lt;!&ndash;金额数据begin&ndash;&gt;-->
<!--<div class="layui-table goods-list" style="width: 100%">-->
<!--<table class="ecsc-default-table ecsc-table-seller mt20 layui-table">-->
<!--<tbody>-->
<!--<tr>-->
<!--<td>-->
<!--<p style="line-height: 30px"></p>-->
<!--<p><span class="font-style"></span>元</p>-->
<!--</td>-->
<!--</tr>-->
<!--</tbody>-->
<!--</table>-->
<!--</div>-->
<!--&lt;!&ndash;金额数据end&ndash;&gt;-->


<!--<form class="layui-form" id="searchForm">-->
<!---->
<!--&lt;!&ndash;<div class="common-head">&ndash;&gt;-->
<!--&lt;!&ndash;<div style="height: 30px;">&ndash;&gt;-->

<!--&lt;!&ndash;<div style="float: left;line-height: 30px;"></div>&ndash;&gt;-->

<!--&lt;!&ndash;<div class="inquire_search" >&ndash;&gt;-->

<!--&lt;!&ndash;<div class="inquire">&ndash;&gt;-->
<!--&lt;!&ndash;<div class="layui-form-item order_item">&ndash;&gt;-->
<!--&lt;!&ndash;<label class="layui-form-label">时间筛选：</label>&ndash;&gt;-->
<!--&lt;!&ndash;<div class="layui-input-block">&ndash;&gt;-->
<!--&lt;!&ndash;<select name="time_type" lay-filter="time">&ndash;&gt;-->
<!--&lt;!&ndash;<option value="0" {eq name=":input('time_type','0')" value='0' } selected {/eq}>天</option>&ndash;&gt;-->
<!--&lt;!&ndash;<option value="2" {eq name=":input('time_type','0')" value='2' } selected {/eq}>周</option>&ndash;&gt;-->
<!--&lt;!&ndash;<option value="3" {eq name=":input('time_type','0')" value='3' } selected {/eq}>月</option>&ndash;&gt;-->
<!--&lt;!&ndash;</select>&ndash;&gt;-->

<!--&lt;!&ndash;<div class="layui-input-inline">&ndash;&gt;-->
<!--&lt;!&ndash;<input type="text" name="end_date" id="end_date" lay-verify="datetime" placeholder="至今" value="{:input('end_date','')}" readonly autocomplete="off" class="layui-input">&ndash;&gt;-->
<!--&lt;!&ndash;</div>&ndash;&gt;-->
<!--&lt;!&ndash;</div>&ndash;&gt;-->
<!--&lt;!&ndash;</div>&ndash;&gt;-->
<!--&lt;!&ndash;</div>&ndash;&gt;-->
<!--&lt;!&ndash;<input type="submit" class="btn search_btn" name="secrch_btn" value="查询">&ndash;&gt;-->
<!--&lt;!&ndash;</div>&ndash;&gt;-->
<!--&lt;!&ndash;</div>&ndash;&gt;-->
<!--&lt;!&ndash;</div>&ndash;&gt;-->

<!--</form>-->

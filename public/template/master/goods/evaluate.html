{extend name='layout/frame' /}
{block name='title'}
{__block__}{/block}

{block name='body'}
{__block__}
<!--操作提示begin-->
<div class="content">
    <div class="explanation" id="explanation">
        <div class="ex_tit">
            <i class="sc_icon"></i><h4>操作提示</h4><span id="explanationZoom" title="收起提示"></span>
        </div>
        <ul>
            <li><span>1、展示了所有用户评论商品的相关信息；</span></li>
            <li><span>2、可以直接回复评论；</span></li>
        </ul>
    </div>
</div>
<!--操作提示end-->
<form class="layui-form" method="get" action="">
    <div class="common-head">
        <!--评价时间-->
        <div class="layui-form-item order_item">
            <label class="layui-form-label">评价时间：</label>
            <div class="imitate_select" style="width: 180px;">
                <input title="评价时间" name="date" type="text" class="layui-input" value="{:input('get.date','')}"
                       id="date" readonly placeholder="按评价时间范围查询">
            </div>
        </div>

        <div class="layui-form-item order_item">
            <label class="layui-form-label">商品评价：</label>
            <div class="imitate_select" style="width: 180px;">
                <select name="star_num" class="cite ps-container">
                    <option value="-1" {eq name=":input('star_num', '-1')" value="-1" }selected{/eq}>全部</option>
                    <option value="1" {eq name=":input('star_num', '-1')" value="1" }selected{/eq}>1颗星</option>
                    <option value="2" {eq name=":input('star_num', '-1')" value="2" }selected{/eq}>2颗星</option>
                    <option value="3" {eq name=":input('star_num', '-1')" value="3" }selected{/eq}>3颗星</option>
                    <option value="4" {eq name=":input('star_num', '-1')" value="4" }selected{/eq}>4颗星</option>
                    <option value="5" {eq name=":input('star_num', '-1')" value="5" }selected{/eq}>5颗星</option>
                </select>
            </div>
        </div>
        <div class="layui-form-item order_item">
            <label class="layui-form-label">店铺评价：</label>
            <div class="imitate_select" style="width: 180px;">
                <select name="store_star_num" class="cite ps-container">
                    <option value="-1" {eq name=":input('store_star_num', '-1')" value="-1" }selected{/eq}>全部</option>
                    <option value="1" {eq name=":input('store_star_num', '-1')" value="1" }selected{/eq}>1颗星</option>
                    <option value="2" {eq name=":input('store_star_num', '-1')" value="2" }selected{/eq}>2颗星</option>
                    <option value="3" {eq name=":input('store_star_num', '-1')" value="3" }selected{/eq}>3颗星</option>
                    <option value="4" {eq name=":input('store_star_num', '-1')" value="4" }selected{/eq}>4颗星</option>
                    <option value="5" {eq name=":input('store_star_num', '-1')" value="5" }selected{/eq}>5颗星</option>
                </select>
            </div>
        </div>
        <div class="layui-form-item order_item">
            <label class="layui-form-label">物流评价：</label>
            <div class="imitate_select" style="width: 180px;">
                <select name="express_star_num" class="cite ps-container">
                    <option value="-1" {eq name=":input('express_star_num', '-1')" value="-1" }selected{/eq}>全部</option>
                    <option value="1" {eq name=":input('express_star_num', '-1')" value="1" }selected{/eq}>1颗星</option>
                    <option value="2" {eq name=":input('express_star_num', '-1')" value="2" }selected{/eq}>2颗星</option>
                    <option value="3" {eq name=":input('express_star_num', '-1')" value="3" }selected{/eq}>3颗星</option>
                    <option value="4" {eq name=":input('express_star_num', '-1')" value="4" }selected{/eq}>4颗星</option>
                    <option value="5" {eq name=":input('express_star_num', '-1')" value="5" }selected{/eq}>5颗星</option>
                </select>
            </div>
            <div class="layui-input-block" style="padding-left: 20px;">
                <input type="hidden" name="goods_id" value="{$goods_id}">
                <button class="layui-btn" lay-submit="">查询</button>
            </div>
        </div>
    </div>
    <hr class="layui-bg-gray">

    <!--列表开始-->
    <div class="layui-form">
        <table class="layui-table">
            <thead>
            <tr>
                <th>会员</th>
                <th>商品评价</th>
                <th>店铺评价</th>
                <th>物流评价</th>
                <th>评价时间</th>
                <th>回复状态</th>
                <th>回复时间</th>
                <th>操作</th>
            </tr>
            </thead>
            <tbody>
            {empty name='data'}
            <tr class='emptyTable'>
                <td colspan="100" style="font-size: 25px;">暂无数据</td>
            </tr>
            {/empty}
            {volist name='data' id='item'}
            <tr>
                <td><img src="{$item.avatar?:'?'}" class="avatar" alt="头像" onerror="this.src='__RES__/image/common/imageError.png'" />
                    {$item.nickname|default=''}</td>
                <td>
                    {switch name="item.star_num"}
                    {case value="1"}<img src="__RES__/image/common/evaluate_1.png">{/case}
                    {case value="2"}<img src="__RES__/image/common/evaluate_2.png">{/case}
                    {case value="3"}<img src="__RES__/image/common/evaluate_3.png">{/case}
                    {case value="4"}<img src="__RES__/image/common/evaluate_4.png">{/case}
                    {case value="5"}<img src="__RES__/image/common/evaluate_5.png">{/case}
                    {default /}出错啦
                    {/switch}
                </td>
                <td>
                    {switch name="item.store_star_num"}
                    {case value="1"}<img src="__RES__/image/common/evaluate_1.png">{/case}
                    {case value="2"}<img src="__RES__/image/common/evaluate_2.png">{/case}
                    {case value="3"}<img src="__RES__/image/common/evaluate_3.png">{/case}
                    {case value="4"}<img src="__RES__/image/common/evaluate_4.png">{/case}
                    {case value="5"}<img src="__RES__/image/common/evaluate_5.png">{/case}
                    {default /}出错啦
                    {/switch}
                </td>
                <td>
                    {switch name="item.express_star_num"}
                    {case value="1"}<img src="__RES__/image/common/evaluate_1.png">{/case}
                    {case value="2"}<img src="__RES__/image/common/evaluate_2.png">{/case}
                    {case value="3"}<img src="__RES__/image/common/evaluate_3.png">{/case}
                    {case value="4"}<img src="__RES__/image/common/evaluate_4.png">{/case}
                    {case value="5"}<img src="__RES__/image/common/evaluate_5.png">{/case}
                    {default /}出错啦
                    {/switch}
                </td>
                <td>{$item.create_time}</td>
                <td>
                    {eq name="item.reply" value="" }
                    未回复
                    {else/}
                    已回复
                    {/eq}
                </td>
                <td>{$item.reply_time}</td>
                <td>
                    <a class="btn_edit" onclick="main.jumpFour('goods_evaluate/edit?id={$item.goods_evaluate_id}')"><i class="fa fa-edit"></i>查看</a>
                </td>
            </tr>
            {/volist}
            </tbody>
            <tfoot>
            {notempty name='data'}
            <tr>
                <td colspan="100">
                    <span style="float:right;">{:$data->render()}</span>
                </td>
            </tr>
            {/notempty}
            </tfoot>
        </table>
    </div>
</form>
<!--列表结束-->
{/block}
{block name='script'}
{__block__}
<script src="__RES__/js/common/preview.js"></script>
<script>
    main.form([{selector:'switch(status)',callback:function (data) {
        main.ajax({type:'post',url:'/goods_evaluate/auditing',data:{'id': data.value},callback:main.callback});
    }}]);

    main.laydate([{
        elem: '#date',
        type: 'date',
        range: true,
        max:0
    }]);

    if ($('a.preview').length) {
        var img = preloadIm();
        imagePreview(img);
    }

    //重定向本身
    function reloadSelf(condition) {
        var param = '', key = Object.keys(condition);
        if (key.length > 0) {
            for (var x in condition) {
                param += '&' + x + '=' + condition[x];
            }
            param = param.substr(1);
        }
        location.href = '?' + param;
    }
</script>
{/block}